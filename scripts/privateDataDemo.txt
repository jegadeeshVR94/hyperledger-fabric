
docker exec -it cli bash

cd /opt/gopath/src/github.com/chaincode/medium

//ORG1 
export CORE_PEER_ADDRESS=peer0.org1.example.com:7051
export CORE_PEER_LOCALMSPID=Org1MSP
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp

//install chaincode on peer0.ORG1
peer chaincode install -n medium -v 1.0 -p github.com/chaincode/medium/

//peer1.org1
export CORE_PEER_ADDRESS=peer1.org1.example.com:7051

//install chaincode on peer1.org1
peer chaincode install -n medium -v 1.0 -p github.com/chaincode/medium/

//ORG2
export CORE_PEER_ADDRESS=peer0.org2.example.com:7051
export CORE_PEER_LOCALMSPID=Org2MSP
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp

//install chaincode on peer0.org2
peer chaincode install -n medium -v 1.0 -p github.com/chaincode/medium/

//peer1.org2
export CORE_PEER_ADDRESS=peer1.org2.example.com:7051
//install chincode on peer1.org2
peer chaincode install -n medium -v 1.0 -p github.com/chaincode/medium/

//instantiate chaincode
export ORDERER_CA=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem
peer chaincode instantiate -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -v 1.0 -c '{"Args":["init"]}' -P "OR('Org1MSP.member','Org2MSP.member')" --collections-config $GOPATH/src/github.com/chaincode/medium/collections_config.json

peer chaincode invoke -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -c '{"Args":["createProduct","1","log","brown","1m","2m", "100", "200"]}'


//query product
peer chaincode query -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -c '{"Args":["getProduct","1"]}'

//query ProductPrice from ORG2
peer chaincode query -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -c '{"Args":["getProductPrice","1"]}'



//change to ORG1
export CORE_PEER_ADDRESS=peer0.org1.example.com:7051
export CORE_PEER_LOCALMSPID=Org1MSP
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp

//invoke from org1
peer chaincode invoke -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -c '{"Args":["createProduct","10","log","brown","1m","2m", "900", "900"]}'



//query product from ORG1
peer chaincode query -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -c '{"Args":["getProduct","1"]}'


//query private data (queryPrice)
peer chaincode query -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -c '{"Args":["getProductPrice","1"]}'


//changed to ORG2
export CORE_PEER_ADDRESS=peer0.org2.example.com:7051
export CORE_PEER_LOCALMSPID=Org2MSP
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt
export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp

//query private data again
peer chaincode query -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -c '{"Args":["getProductPrice","1"]}'


//add new records

peer chaincode invoke -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -c '{"Args":["createProduct","3","log","black","2m","2m", "300", "300"]}'

peer chaincode invoke -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -c '{"Args":["createProduct","4","log","black","2m","2m", "400", "400"]}'

peer chaincode invoke -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -c '{"Args":["createProduct","5","log","black","2m","2m", "500", "500"]}'

peer chaincode invoke -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -c '{"Args":["createProduct","6","log","black","2m","2m", "600", "600"]}'

peer chaincode invoke -o orderer.example.com:7050 --tls --cafile $ORDERER_CA -C mychannel -n medium -c '{"Args":["createProduct","7","log","black","2m","2m", "700", "700"]}'
